-- Create a table for UGC Reports
create table reports (
  id bigint generated by default as identity primary key,
  user_id uuid references auth.users not null,
  reason text not null,
  mode text not null,
  completed boolean default false,
  object_type text,
  object_id text,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null
);

alter table reports enable row level security;

create policy "Users can delete their own reports."
  on reports for delete
  using (auth.uid() = user_id);

create policy "Users can insert their own reports."
  ON public.reports
  FOR INSERT 
  TO authenticated 
  WITH CHECK (true);

CREATE POLICY "Users can view their own reports."
ON public.reports
FOR SELECT 
TO authenticated 
WITH (true);

create policy "Users can update own reports."
  on reports for update
  using ( auth.uid() = user_id );
